return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1,1)
res<-solnp(pars=pars,fun=log.lik,LB=c(0,0),control=list(trace=0))
param<-res$pars
return(param)
}
max.ver(datos)
log.lik<-function(param)
{
a<-param[1];b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
par<-c(1,1)
res<-solnp(par=par,fn=log.lik)
res<-optim(par=par,fn=log.lik)
datos
log.lik<-function(param)
{
a<-param[1];b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
log.lik(c(8,0.8))
res<-optim(par=par,fn=log.lik,lower=0)
res<-optim(par=par,fn=log.lik,method="L-BFGS-B",lower=0)
str(res)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-param[1];b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
par<-c(10,1)
res<-optim(par=par,fn=log.lik,method="L-BFGS-B",lower=0)
param<-res$pars
return(param)
}
res<-optim(par=par,fn=log.lik,lower=0)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-param[1];b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
par<-c(10,1)
res<-optim(par=par,fn=log.lik,method="L-BFGS-B",lower=0)
param<-res$pars
return(param)
}
max.ver(datos)
par<-c(0,0)
res<-optim(par=par,fn=log.lik)
par<-c(0.1,0.1)
res<-optim(par=par,fn=log.lik)
res
a<-80;b<-0.8
datos<-r(100,a,b)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-param[1];b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
par<-c(0.1,0.1)
res<-optim(par=par,fn=log.lik)
param<-res$pars
return(param)
}
max.ver(datos)
datos<-r(100,8,0.8)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-8#param[1];
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
par<-c(1)
res<-optim(par=par,fn=log.lik)
param<-res$pars
return(param)
}
max.ver(datos)
library(Rsolnp)
help(solnp)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-8#param[1];
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-8#param[1];
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
par<-c(1)
res<-solnp(pars=pars,fun=log.lik)
param<-res$pars
return(param)
}
max.ver(datos)
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-8#param[1];
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1)
res<-solnp(pars=pars,fun=log.lik)
param<-res$pars
return(param)
}
max.ver(datos)
warnings
warnings()
log.lik<-function(param)
{
a<-8#param[1];
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
res<-solnp(pars=pars,fun=log.lik,LB = c(0),control=list(trace=0))
param<-res$pars
param
log.lik<-function(param)
{
a<-param[1];
b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1,1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
param
pars<-c(5,1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
param
pars<-c(15,1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
param
max.ver<-function(datos)
{
log.lik<-function(param)
{
a<-param[1];
b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1,1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
return(param)
}
###Ejemplo:
a<-8;b<-0.8
datos<-r(1000,a,b)
h.0<-function(t)return(h(t,a=a,b=b))
curve(h.0(x),0,1,ylim=c(0,10))
max.ver(datos)
log.lik<-function(param)
{
a<-8;
b<-param
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0),control=list(trace=0))
param<-res$pars
curve(log.lik)
param<-seq(0,4,length=100)
ll<-double(n)
ll<-double(100)
for(i in 1:100){ll[i]<-log.lik(param[i])
}
plot(param,ll)
log.lik<-function(param)
{
a<-param;
b<-0.8
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
for(i in 1:100){ll[i]<-log.lik(param[i])
}
plot(param,ll)
param<-1:30
for(i in 1:length(param)){ll[i]<-log.lik(param[i])}
plot(param,ll)
ll<-double(length(param))
for(i in 1:length(param)){ll[i]<-log.lik(param[i])}
plot(param,ll)
log.lik<-function(param)
{
a<-param[1];
b<-param[2]
n<-length(datos)
f.datos<-double(n)
for(i in 1:n){f.datos[i]<-f(datos[i],a,b)}
return(-sum(log(f.datos)))
}
library(Rsolnp)
pars<-c(1,1)
res<-solnp(pars=pars,fun=log.lik,LB = c(0,0),control=list(trace=0))
param<-res$pars
param
res<-solnp(pars=pars,fun=log.lik)#,LB = c(0,0),control=list(trace=0))
simula.Wmod<-function(n,a,b,c) {
uu<-runif(n)
f.u<-function(t,u)
return(b*log(t)+c*t+log(a)-log(-log(1-u)))
t.u<-sapply(1:n,function(i)
{return(uniroot(f.u,c(0,1e+04),u=uu[i])$root)})
i0<-which(t.u==0)
t.u[i0]<-t.u[i0]+1e-4
t.u }
n <- 250
(t <- simula.Wmod(n,1,2,0.5))
f.likWmod<-function(x) {
a <- x[1]
b <- x[2]
c <- x[3]
log.lik1 <- n*log(a)+(b-1)*sum(log(t))+sum(log(b+c*t)) +c*sum(t)-a*sum(t^(b)*exp(c*t))
return(-log.lik1) }
grWmod <- function(x) {
a <- x[1]
b <- x[2]
c <- x[3]
gr1 <- sum((1/a)-t^(b)*exp(c*t))
gr2 <- sum(log(t)+1/(b+c*t)-a*t^(b)*exp(c*t)*log(t))
gr3 <- sum(t/(b+c*t)+t-a*t^(b+1)*exp(c*t))
return <- c(-gr1,-gr2,-gr3) }
(result1 <- optim(c(1.5,2.36,1), f.likWmod, grWmod, method = "BFGS"))
vari.M<-function(n)return(n^{-8/9}
vari.M<-function(n)return(n^{-8/9})
vari.LL<-function(n)return(n^{-4/5})
curve(vari.M(x),1,200,ylim=c(0,1))
curve(vari.LL(x),1,200,ylim=c(0,1),add=T,col=2)
28/45
4/9
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/ficherosdelgrid/error1")
K<-1:5;
Ns<-c(50,100,500,1000)
param<-expand.grid(K,Ns)
#
# #
M<-200
error50<-matrix(NA,1,3)
for (num in 1:5)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error50<-rbind(error50,res)
}
colnames(error50)<-c( "i" ,"SiZer-0","SiZer-2")
error50<-error50[-1,]
sapply(error50[,-1],sd)
sapply(error50,sd)
head(error50)
sapply(error50[,2:3],sd)
head(error50)
colMeans(error50[,2:3])
sapply(error50[,2:3],sd)
sapply(1:2,function(i)sd(error[,(i+1)]))
sapply(1:2,function(i)sd(error50[,(i+1)]))
is.data.frame(error50)
error50<-as.data.frame(error50)
sapply(error50[,2:3],sd)
K<-1:5;
Ns<-c(50,100,500,1000)
param<-expand.grid(K,Ns)
#
# #
M<-200
error50<-matrix(NA,1,3)
for (num in 1:5)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error50<-rbind(error50,res)
}
colnames(error50)<-c( "i" ,"SiZer-0","SiZer-2")
error50<-error50[-1,]
#####
error100<-matrix(NA,1,3)
for (num in 6:10)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error100<-rbind(error100,res)
}
colnames(error100)<-c( "i" ,"SiZer-0","SiZer-2")
error100<-error100[-1,]
#####
error500<-matrix(NA,1,3)
for (num in 11:15)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error500<-rbind(error500,res)
}
colnames(error500)<-c( "i" ,"SiZer-0","SiZer-2")
error500<-error500[-1,]
#####################
error1000<-matrix(NA,1,3)
for (num in 16:20)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error1000<-rbind(error1000,res)
}
colnames(error1000)<-c( "i" ,"SiZer-0","SiZer-2")
error1000<-error1000[-1,]
error1000<-matrix(NA,1,3)
for (num in 16:20)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error1000<-rbind(error1000,res)
}
num<-16
K<-1:5;
Ns<-c(50,100,500,1000)
param<-expand.grid(K,Ns)
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/resultados_tablas")
error1000<-read.table('TypeI_error_N_1000.txt',h=T)
head(error1000)
summary(error1000)
sapply(error1000[,2:3],sd)
boxplot(error1000[,2:3])
which.max(error1000[,2])
ss<-416
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/ficherosdelgrid/error1")
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA")
# Add the needed libraries
library(ggplot2)
library(reshape2)
library(dplyr)
library(lubridate)
library(latex2exp)
library(ggpubr)
source("tools.R",    encoding="utf-8")
N<-1000
ss<-416
set.seed(ss)
myData<-rexp(N)
if(N==50){xgrid=21; hMin=0.1; hMax=1}
if(N==100){xgrid=51; hMin=0; hMax=1}
if(N==500){xgrid=401; hMin=0; hMax=1}
if(N==1000){xgrid=401; hMin=0;hMax=0.9}
ttt(myData=myData,xgrid=xgrid,bootstrapSample = 500,hMin=hMin,hMax=hMax)
source('ttt.r')
ttt(myData=myData,xgrid=xgrid,bootstrapSample = 500,hMin=hMin,hMax=hMax)
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/ficherosdelgrid/error1")
e50<-read.table('Error_TypeI_N_50.txt',h=T)
summary(e50[,2:3])
summary(e50[,2])
help("summary")
quartile
e50<-read.table('Error_TypeI_N_100.txt',h=T)
e50<-read.table('Error_TypeI_N_50.txt',h=T)
summary(e50[,2])
e50<-read.table('Error_TypeI_N_100.txt',h=T)
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/resultados_tablas")
e50<-read.table('Error_TypeI_N_100.txt',h=T)
e50<-read.table('TypeI_N_50.txt',h=T)
e100<-read.table('TypeI_N_100.txt',h=T)
e100<-read.table('TypeI_error_N_100.txt',h=T)
summary(e100[,2])
summary(e100[,3])
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/ficherosdelgrid/error1")
K<-1:5;
Ns<-c(50,100,500,1000)
param<-expand.grid(K,Ns)
#
# #
M<-200
error50<-matrix(NA,1,3)
for (num in 1:5)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error50<-rbind(error50,res)
}
colnames(error50)<-c( "i" ,"SiZer-0","SiZer-2")
error50<-error50[-1,]
#####
error100<-matrix(NA,1,3)
for (num in 6:10)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error100<-rbind(error100,res)
}
colnames(error100)<-c( "i" ,"SiZer-0","SiZer-2")
error100<-error100[-1,]
summary(error100[,2])
summary(error100[,3])
summary(error50[,2])
#####
error500<-matrix(NA,1,3)
for (num in 11:15)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error500<-rbind(error500,res)
}
colnames(error500)<-c( "i" ,"SiZer-0","SiZer-2")
error500<-error500[-1,]
summary(error500[,2])
summary(error500[,3])
error1000<-matrix(NA,1,3)
for (num in 16:20)
{
tarea<-param[num,1]
N<-param[num,2]
fil.res<-paste('Error_TypeI_N_',N,'_tarea_',tarea,'.txt',sep="")
res<-as.matrix(read.table(fil.res,h=T),M,3)
error1000<-rbind(error1000,res)
}
colnames(error1000)<-c( "i" ,"SiZer-0","SiZer-2")
error1000<-error1000[-1,]
setwd("C:/Users/Usuario/Dropbox/TTT_noRAFA/resultados_tablas")
error1000<-read.table('TypeI_error_N_1000.txt',h=T)
summary(error1000[,2])
summary(error1000[,3])
